<ui:composition template="template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:k="http://java.sun.com/jsf/composite/kinocomp">

	<ui:define name="css">

		<style type="text/css">
.seat {
	border-radius: 50%;
	background-color: gray;
	color: white;
	text-align: center;
	text-decoration: none;
	margin: auto;
	border: solid;
	height: 19px;
	width: 19px;
}

.selected {
	background-color: #E9365A;
}

.leinwand {
	background-color: gray;
	border-width: 20px;
	border-color: white;
	color: white;
	text-align: center
}

.noborder {
	border: none;
	text-align: center;
	padding: 0px;
}

.PREMIUM {
	background-color: #f1c40f;
}

.RESERVED {
	background-color: #E9365A;
}

.HIDDEN {
	visibility: hidden;
}

.SOLD {
	background-color: #2c3e50;
}

.HANDYCAP {
	background-color: #3498db;
}

select {
	color: #4f4f4f;
}
</style>

	</ui:define>
	
	<ui:define name="content">
		<div class="panel panel-default">
			<div class="panel-heading">
	    		<h:outputText class="font-h2" value="#{msg.mvishw_lbl_title}"/>
				<h:outputText class="font-h3 leftspace-30" value="#{movieEventController.movieEventSummary}"/>			
	    	</div>
	    	<div class="panel-body">
	    		<div class="row">
	    			
	    			<!-- Kinosaal -->
				    <div class="col-sm-6 text-center">
	    				<p class="font-h3">#{msg.mvishw_lbl_info}</p>
	    				<!-- Legende -->
	    				<div>
							<h:commandButton readonly="true" styleClass="seat RESERVED"/> <h:outputText class="rightspace-20" value="#{msg.mvishw_lbl_meinePlaetze}"/>
							<h:commandButton readonly="true" styleClass="seat NORMAL"/> <h:outputText class="rightspace-20" value="#{msg.mvishw_lbl_frei}"/>
							<h:commandButton readonly="true" styleClass="seat SOLD"/> <h:outputText class="rightspace-20" value="#{msg.mvishw_lbl_verkauft}"/>
							<h:commandButton readonly="true" styleClass="seat PREMIUM"/> <h:outputText class="rightspace-20" value="#{msg.mvishw_lbl_premium}"/>
							<h:commandButton readonly="true" styleClass="seat HANDYCAP"/> <h:outputText value="#{msg.mvishw_lbl_handicap}"/>
						</div>
						
	    				<!-- Sitzplan -->					
						<h:form id="outerForm" prependId="false">
							<table class="noborder">
								<tr>
									<td colspan="100%" class="leinwand">#{msg.mvishw_lbl_leinwand}</td>
								</tr>
								<ui:repeat var="row" value="#{kinoSaalManager.returnRows()}">
									<tr class="noborder">
										<ui:repeat var="i" value="#{kinoSaalManager.returnOneRow(row)}">
											<td class="noborder">
												<h:commandButton id="seatButton" 
																 action="#{i.reserve()}" 
																 styleClass="seat #{kinoSaalManager.style(i)}" 
																 disabled="#{i.isOccupied()}">
													<f:ajax render=":outerForm :ticketForm" />				 
												</h:commandButton> 
												<p:tooltip for="seatButton" value="#{msg.mvishw_seats_row} #{i.seatRow + 1}, #{msg.mvishw_seats_seat} #{i.seatColumn + 1}"/>
											</td>
										</ui:repeat>
									</tr>
								</ui:repeat>
							</table>
						</h:form>	
	    			</div>
	    			
	    			<!-- Tickets -->
				    <div class="col-sm-6">
						
						<div>
							<div class="col-sm-5 text-left">
								<h:form id="xxxxForm" prependId="false">
									<span style="color: indianred;">#{msg.mvishw_ticket_lbl_reservierung} <h:outputText id="txt_count" value="#{kinoSaalManager.timeoutSecond}" /> <i class="fa fa-clock-o fa-spin" aria-hidden="true"></i> <p:poll interval="1" listener="#{kinoSaalManager.remainingSeconds}" update="txt_count" /></span>
								</h:form>
							</div>
							<div class="col-sm-7 text-right">
								<h:form class="btmspace-10">
									<h:commandLink id="resetReservedSeats" class="btn btn-danger btn-xs" 
												   action="#{kinoSaalManager.resetReservedSeats()}">
										<f:ajax render=":outerForm :ticketForm" />
							 			<span class="glyphicon glyphicon-trash"></span> <h:outputText value="#{msg.mvishw_ticket_btn_entfernen}"/>
							 		</h:commandLink>
							 		
									<h:commandLink class="btn btn-primary btn-xs" 
												   action="#{navigationController.goToStep3()}">
							 			<span class="glyphicon glyphicon-shopping-cart"></span> <h:outputText value="#{msg.mvishw_ticket_btn_kaufen}"/>
							 		</h:commandLink>
						 		</h:form>
							</div>
							
						
					      	<div class="col-sm-12">
				 				<ui:include src="ticketTable.xhtml"></ui:include>
				 			</div>
					 		
						</div>
					</div>
					
	    		</div>
	    		
	    	</div>
		</div>
	    	
	</ui:define>
</ui:composition>